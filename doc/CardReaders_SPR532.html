<html xmlns="http://www.w3.org/1999/xhtml" xmlns:html="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>CardReaders/SPR532 - OpenSC - Trac</title><style type="text/css">
           @import url(trac.css);
          </style></head><body><div class="wikipage">
    <div id="searchable"><h1>PinPad AKA SPR532 and OpenSC mini-howto</h1>
<p>
To get feedback as early as possible, here's a small tutorial how to get going with SPR532 and pinpad. There are other <a href="PinpadReaders.html" shape="rect">PinpadReaders</a> and other interfaces but the given interface makes use of <a class="ext-link" title="http://www.pcscworkgroup.com/specifications/overview.php" href="http://www.pcscworkgroup.com/specifications/overview.php" shape="rect">PC/SC version 2.0 spec</a> Part 10.
</p>
<p>
Things you need to try it out:
</p>
<ul><li>get yourself a SPR532 reader from www.scmmicro.com
</li><li>upgrade the firmware to the latest (at least 5.05) version using stuff from here: 
</li></ul><p>
<a class="ext-link" title="http://www.scmmicro.com/support/pcs_downloads.html?PID=70&amp;s1=6&amp;s2" href="http://www.scmmicro.com/support/pcs_downloads.html?PID=70&amp;s1=6&amp;s2" shape="rect">http://www.scmmicro.com/support/pcs_downloads.html?PID=70&amp;s1=6&amp;s2</a>
</p>
<ul><li><ul><li>Note that this upgrade will make your reader's pinpad unusable under Windows if your application only supports the older and broken firmware!
</li></ul></li><li>make sure you have libusb installed (you can get it from here: <a class="ext-link" title="http://www.opensc-project.org/svn/ideelabor/trunk/mp/libusb" href="http://www.opensc-project.org/svn/ideelabor/trunk/mp/libusb" shape="rect">http://www.opensc-project.org/svn/ideelabor/trunk/mp/libusb</a>)
</li><li>install the latest pcsc-lite from SVN (or from here: <a class="ext-link" title="http://www.opensc-project.org/svn/ideelabor/trunk/mp/pcsc-lite" href="http://www.opensc-project.org/svn/ideelabor/trunk/mp/pcsc-lite" shape="rect">http://www.opensc-project.org/svn/ideelabor/trunk/mp/pcsc-lite</a>)
</li><li>install the latest ccid driver from SVN (or from here: <a class="ext-link" title="http://www.opensc-project.org/svn/ideelabor/trunk/mp/ccid" href="http://www.opensc-project.org/svn/ideelabor/trunk/mp/ccid" shape="rect">http://www.opensc-project.org/svn/ideelabor/trunk/mp/ccid</a>)
</li><li>install the latest opensc from SVN (or get one from here: <a class="ext-link" title="http://www.opensc-project.org/svn/ideelabor/trunk/mp/opensc" href="http://www.opensc-project.org/svn/ideelabor/trunk/mp/opensc" shape="rect">http://www.opensc-project.org/svn/ideelabor/trunk/mp/opensc</a>)
<ul><li>After installation, make sure you have opensc.conf in the location told by configure and make sure that enable_pinpad is set to 'true'
</li></ul></li></ul><p>
   
Notes:
</p>
<ul><li>the whole topic is hairy - see discussions on muscle and opensc-devel mailinglist:
<ul><li><a class="ext-link" title="http://archives.neohapsis.com/archives/dev/muscle/2005-q1/0199.html" href="http://archives.neohapsis.com/archives/dev/muscle/2005-q1/0199.html" shape="rect">http://archives.neohapsis.com/archives/dev/muscle/2005-q1/0199.html</a>
</li><li><a class="ext-link" title="http://archives.neohapsis.com/archives/dev/muscle/2005-q1/0221.html" href="http://archives.neohapsis.com/archives/dev/muscle/2005-q1/0221.html" shape="rect">http://archives.neohapsis.com/archives/dev/muscle/2005-q1/0221.html</a>
</li><li><a class="ext-link" title="http://www.opensc-project.org/pipermail/opensc-devel/2005-March/005709.html" href="http://www.opensc-project.org/pipermail/opensc-devel/2005-March/005709.html" shape="rect">http://www.opensc-project.org/pipermail/opensc-devel/2005-March/005709.html</a>
</li></ul></li></ul><p>
What you can do:
</p>
<ol><li>test and provide feedback
</li><li>make the code of ccid library better. It seriously looks ugly when the SecurePIN functions come to play - though it works.
</li><li>help to argue how things should look like in different places and how we shall solve some issues - see <a href="DesignDiscussion.html" shape="rect">DesignDiscussion</a>
</li></ol><p>
Known issues: 
</p>
<ol><li>It is known to work with SPR532 under Linux. In theory it should work without modifications on windows using the latest windows drivers available from the SCM specific download location above. In practice it doesn't because that given method is not supported by the windows driver. 
</li><li>Support is only for T=0 cards (as of now Estonian and Belgian eID cards have been tested on Linux). It might as well work with T=1 cards, but to try it out you must disable the check for active protocol in reader-pcsc.c. Write a note here if it works.
</li><li>Support for pinpad operations in general might lag behind your needs. Patches most welcome :)
</li></ol><p>
Open questions:
</p>
<ol><li>SCM seems to also offer a CCID driver for LINUX: <a class="ext-link" title="http://www.scmmicro.com/support/pcs_product_drivers.html" href="http://www.scmmicro.com/support/pcs_product_drivers.html" shape="rect">http://www.scmmicro.com/support/pcs_product_drivers.html</a> Has anyone tested it? Does it work? martin: the usual 'binary only' whining applies. Also, there should be no difference from the pcsc v2 part 10 point of view.
</li></ol></div>
   </div><div class="footer"><hr></hr><p><a href="index.html">Back to Index</a></p></div></body></html>
